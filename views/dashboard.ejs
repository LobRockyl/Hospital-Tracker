<head>
  <title>Dashboard</title>
<meta name="description" content="The Hospital Tracker is a non-profit social platform aimed to gather these reports against the healthcare giants, 
hospitals, and nursing homes in critical states in India. Instead of just posting on social media, we gather 
authenticated reports against the hospitals or anything related, so that this pack of authenticated reports and 
behaviour can be claimed by the people who practice law or are at a place of power to take action based on authenticated hospital data" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"></link>
  <script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous"></script>
  <script
        src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"
        integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut"
        crossorigin="anonymous"
    ></script>
  <script
    src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"
    integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
    crossorigin="anonymous"
    ></script>
  
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>


  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css"/>
</head>
<style>
  body{
margin:0px;  
}
</style>
<!-- Modal -->
<div class="modal fade" id="exampleModal1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Feedback</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        
        <div class="form-group">
    <label for="exampleInputEmail1">Hospital Name</label>
    <input type="email" class="form-control" id="Hospital_name" aria-describedby="emailHelp">
    <small id="emailHelp" class="form-text text-muted"></small>
  </div>
        <div class="form-group">
    <label for="exampleInputEmail1">Description</label>
    <input type="email" class="form-control" id="description" aria-describedby="emailHelp">
  </div>
       <h1>Rate the Hospital</h1>
<fieldset class="rating">
    <input type="radio" id="star5" name="rating" value="5" /><label class = "full" for="star5" title="Awesome - 5 stars"></label>
    <input type="radio" id="star4half" name="rating" value="4 and a half" /><label class="half" for="star4half" title="Pretty good - 4.5 stars"></label>
    <input type="radio" id="star4" name="rating" value="4" /><label class = "full" for="star4" title="Pretty good - 4 stars"></label>
    <input type="radio" id="star3half" name="rating" value="3 and a half" /><label class="half" for="star3half" title="ok - 3.5 stars"></label>
    <input type="radio" id="star3" name="rating" value="3" /><label class = "full" for="star3" title="OK - 3 stars"></label>
    <input type="radio" id="star2half" name="rating" value="2 and a half" /><label class="half" for="star2half" title=" bad - 2.5 stars"></label>
    <input type="radio" id="star2" name="rating" value="2" /><label class = "full" for="star2" title="bad - 2 stars"></label>
    <input type="radio" id="star1half" name="rating" value="1 and a half" /><label class="half" for="star1half" title="ok - 1.5 stars"></label>
    <input type="radio" id="star1" name="rating" value="1" /><label class = "full" for="star1" title="very bad - 1 star"></label>
    <input type="radio" id="starhalf" name="rating" value="half" /><label class="half" for="starhalf" title="very bad - 0.5 stars"></label>
</fieldset>
      <style>
        @import url(//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css);

fieldset, label { margin: 0; padding: 0; }
body{ margin: 20px; }
h1 { font-size: 1.5em; margin: 10px; }

/****** Style Star Rating Widget *****/

.rating { 
  border: none;
  float: left;
}

.rating > input { display: none; } 
.rating > label:before { 
  margin: 5px;
  font-size: 1.25em;
  font-family: FontAwesome;
  display: inline-block;
  content: "\f005";
}

.rating > .half:before { 
  content: "\f089";
  position: absolute;
}

.rating > label { 
  color: #ddd; 
 float: right; 
}

/***** CSS Magic to Highlight Stars on Hover *****/

.rating > input:checked ~ label, /* show gold star when clicked */
.rating:not(:checked) > label:hover, /* hover current star */
.rating:not(:checked) > label:hover ~ label { color: #FFD700;  } /* hover previous stars in list */

.rating > input:checked + label:hover, /* hover current star when changing rating */
.rating > input:checked ~ label:hover,
.rating > label:hover ~ input:checked ~ label, /* lighten current selection */
.rating > input:checked ~ label:hover ~ label { color: #FFED85;  } 
      </style>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>
<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Complaint Status</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
       <p><%= typeof msg != 'undefined' ? msg+" report(s) under review. You will recieve an email regarding the same." : 'You have not submitted any complaints' %></p>
       <p><small>Please submit the form carefully and under the correct category.
       Only one report is allowed per user uptill it has been verified. For more information <a>Click Here</a></small></p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div style="display:flex; flex-direction: row">
<h1>Hello <%=user.name%> </h1>
  <div class="dropdown">
    <button class="btn btn-light dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
       <i class="fa fa-user-circle-o" aria-hidden="true"></i>
    </button>
    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
      <a id="complaint_status" class="dropdown-item" data-toggle="modal" data-target="#exampleModal">Complaint status</a>
      <a class="dropdown-item" href="/users/logout">Logout</a>
    </div>
  </div>

</div>
<div id="verification">
<div class="card-deck" >
  <div class="card">
      <div class="card-body">
        <h5 class="card-title">Patient</h5>
        <p class="card-text">Proceed to the portal to report a problem or give us a feedback of the hospital.</p>
        <p class="card-text">
          <div id="list-example" class="list-group">
  <a type="button" class="btn btn-success" href="#list-item-1">Portal</a>
          <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal1">
  Feedback</button>
          </div>
          

        </p>
      </div>
    </div>
  <div class="card">
 
      <div class="card-body">
        <h5 class="card-title">Hospital</h5>
        <p class="card-text">You need to verify as a hospital authority.</p>
        <p class="card-text">
          <a href="dashboard/hospital"><button  type="button" class="btn btn-success">Proceed</button></a>

        </p>
      </div>
    </div>
  <div class="card">  
      <div class="card-body">
        <h5 class="card-title">Municipal Executive</h5>
        <p class="card-text">Click here to proceed to verification</p>
        <p class="card-text">
          <a href="dashboard/officer"><button  type="button" class="btn btn-success">Proceed</button></a>
        </p>
      </div>
    </div>
</div>
  </div>


<div class="jumbotron jumbotron-fluid">
  <div class="container">
    <h6>Search by State/City:</h6>
  
   <div style="display:flex;flex-direction: row">
   <select id="select_state" name="select_state" class="form-control form-control-sm" style="width:90%">
  <option>Mumbai</option>
  <option>Delhi</option>
  <option>Pune</option>
  <option>Nagpur</option>
  <option>Karnataka</option>
  <option>Tamil Nadu</option>
  </select><button id="bakwas-2" class="btn btn-outline-success" style="padding-bottom:0" type="submit"><i class="fa fa-search" aria-hidden="true"></i></button>
  </div>

    <div class="ui-widget" style="z-index:9999">
      <form action="/search" method="POST" class="form-inline my-2 my-lg-0" id="chutiya" style="width:90%;display:flex;flex-direction: row;flex-flow:row;">
        <input style="width:90%" class="form-control mr-sm-2" id="hospital_search" type="search" placeholder="Search Hospital" aria-label="Search"/>
        <button  id="bakwas" class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
      </form>
    </div>
      </div>
</div>
 <div id="info"  class="row">
  
</div>
<h1>Portal</h1>
<div class="accordion" id="accordionExample" data-spy="scroll" data-target="#list-example" data-offset="0" >
  <div class="card">
    <div class="card-header" id="headingOne">
      <h2 class="mb-0">
        <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
          <h3 id="list-item-1"><i class="fa fa-heartbeat" aria-hidden="true"></i>
          Patient</h3>
        </button>
      </h2>
    </div>

    <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordionExample">
      <div class="card-body">
         <form action="/dashboard/submit" method="POST">
          <div class="form-group">
            <label for="name">Name</label>
            
            <input type="name" name="name" class="form-control" id="name" value="<%= typeof name != 'undefined' ? name : '' %>" placeholder="<%=user.name%>">
          </div>
          <div class="form-group">
            <label for="pselect">Type:</label>
            <select class="form-control" id="pselect" name="pselect" value="<%= typeof pselect != 'undefined' ? pselect : '' %>">
              <option>Patient</option>
              <option>Related or Other</option>
            </select>
          </div>
           <div class="form-group">
            <label for="pselect" type="required">Category of Problem:</label>
            <select class="form-control" id="pselect" name="pselect" value="<%= typeof pselect != 'undefined' ? pselect : '' %>">
              <option>Overcharging</option>
              <option>No Ventilator</option>
              <option>No ICU</option>
              <option>Admitted but unattended</option>
              <option>Lack of hygiene</option>
              <option>Other problem...</option>

            </select>
          </div>

          <div class="form-group">
            <label for="pdesc">Problem Description</label>
            <input class="form-control" id="pdesc" name="pdesc" value="<%= typeof pdesc != 'undefined' ? pdesc : '' %>" rows="3"></input>
          </div>
           <div class="form-group">
             <label for="pcheck">Type:</label>
             <select class="form-control" id="pcheck" name="pcheck">
               <option>I will be able to provide evidence to my problem(Recommended)</option>
               <option>No evidence can be provided by me</option>
             </select>
           </div>
           <button type="submit" id="dashboard_submit" class="btn btn-primary" style="display:<%= typeof msg != 'undefined'? "none" : 'block'%>">Submit</button>
        </form> 
      </div>
    </div>
  </div>
  <div class="card">
    <div class="card-header" id="headingTwo">
      <h2 class="mb-0">
        <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
          <h3>
            <i class="fa fa-stethoscope" aria-hidden="true"></i>
            Doctor
          </h3>
        </button>
      </h2>
    </div>
    <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionExample">
      <div class="card-body">
        <form action="/dashboard/docsubmit" method="POST">
          <div class="form-group">
            <label for="exampleFormControlInput1">Name</label>
            <input type="name" name="name" class="form-control" id="name" value="<%= typeof name != 'undefined' ? name : '' %>" placeholder="<%=user.name%>">
          </div>
          <div class="form-group" id="Registration_number">
            <label for="exampleFormControlInput1">MCI Registration number</label>

            <input type="reg_no" id="reg_no" name="reg_no" class="form-control"  placeholder="MCI/Registration ID">
          </div>
         
          <div class="form-group" id="">
            <label for="exampleFormControlInput1">State Medical Council</label>

            <input  class="form-control" type="council" id="council" name="council" placeholder="example: West Bengal Medical Council">
          </div>
          <div class="form-group" id="">
            <input type="email" class="form-control" type="qualification" id="qualification" name="qualification" placeholder="Qualification">
          </div>
          <div class="form-group" id="">
            <label for="exampleFormControlInput1">Add/Rectify/Claim:</label>

            <input type="rectify_data" id="rectify_data" name="rectify_data" class="form-control"  placeholder="Data you want to add/rectify">
          </div>
          <div class="form-group" id="">
            <label for="exampleFormControlInput1">Any other problems(if any):</label>

            <input class="form-control" type="problem" id="problem" name="problem" placeholder="Problem/Query">
          </div>
          <div class="form-group">
            <label for="exampleFormControlTextarea1">Brief Description</label>
            <input type="doc_desc" id="doc_desc" name="doc_desc" class="form-control" ></input>
          </div>
          <div class="form-group">
            <label for="doccheck">Type:</label>
            <select class="form-control" id="doccheck" name="doccheck" >
              <option>I would be able to provide evidence to my problem(Recommended)</option>
              <option>No evidence</option>
            </select>
          </div>
          <button type="submit" id="dashboard_submit" class="btn btn-primary" style="display:"
            <%= typeof msg != 'undefined'? "none" : 'block'%>">Submit
          </button>

        </form>
      </div>
    </div>
  </div>
  <div class="card">
    <div class="card-header" id="headingThree">
      <h2 class="mb-0">
        <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
         <h3>
           <i class="fa fa-medkit" aria-hidden="true"></i>
           Healthcare Professional</h3>
        </button>
      </h2>
    </div>
    <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordionExample">
      <div class="card-body">
        <form action="/dashboard/staffsubmit" method="POST">
          <div class="form-group">
            <label for="exampleFormControlInput1">Name</label>
            <input  class="form-control" type="name" id="name" name="name" placeholder="<%=user.name%>">
            
          </div>
          <div class="form-group">
            <label for="exampleFormControlInput1">Verification</label>
            <input  class="form-control" type="verify" id="verify" name="verify" placeholder="Any information to verify your designation">
          </div>
          <div class="form-group">
            <label for="exampleFormControlTextarea1">Problem Description</label>
            <input class="form-control" type="pdesc" id="pdesc" name="pdesc"></input>
          </div>
          <div class="form-group">
            <label for="scheck">Type:</label>
            <select class="form-control" id="scheck" name="scheck">
              <option>I would be able to provide evidence to my problem(Recommended)</option>
              <option>No evidence</option>
            </select>
          </div>
          <button type="submit" id="dashboard_submit" class="btn btn-primary" style="display:"
            <%= typeof msg != 'undefined'? "none" : 'block'%>">Submit
          </button>

        </form>
      </div>
    </div>
  </div>
  <div class="card">
    <div class="card-header" id="headingOne">
      <h2 class="mb-0">
        <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseFour" aria-expanded="true" aria-controls="collapseFour">
          <h3>Any other concerned citizen...</h3>
        </button>
      </h2>
    </div>
    <div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-parent="#accordionExample">
      <div class="card-body">
        <form action="/dashboard/othersubmit" method="POST">
          <div class="form-group">
            <label for="name">Name</label>
            <input type="name" id="name" name="name" class="form-control" id="exampleFormControlInput1" placeholder=<%=user.name%>>
          </div>
          <div class="form-group">
            <label for="exampleFormControlInput1">Profession</label>
            <input  class="form-control" type="occ" id="occ" name="occ" placeholder="example: Govt. Service at Organization">
          </div>
              
          <div class="form-group">
            <label for="opdesc">Problem Description</label>
            <input class="form-control" type="opdesc" id="opdesc" name="opdesc"></input>
          </div>
          <div class="form-group">
            <label for="opcheck">Type:</label>
            <select class="form-control" id="opcheck" name="opcheck">
              <option>I would be able to provide evidence to my problem(Recommended)</option>
              <option>No evidence</option>
            </select>
          </div>
          <button type="submit" id="dashboard_submit" class="btn btn-primary" style="display:"
            <%= typeof msg != 'undefined'? "none" : 'block'%>">Submit
          </button>

        </form>
      </div>
    </div>
  </div>
</div>
<div class="card mb-3" style="max-width:100%;">
      <div class="row no-gutters">
        <div class="col-md-4">
          <img src="https://i.imgur.com/SqQWbJb.png" class="card-img" alt="ss">
    </div>
        <div class="col-md-8">
          <div class="card-body">
            <h5 class="card-title" href="/app">The Hospital Tracker</h5>
            <p class="card-text">A handy tool to get your hospital's information.</p>
            <p class="card-text">
              <a href="/app">
                <i class="fa fa-download" aria-hidden="true"></i> Download
              </a>
            </p>
          </div>

        </div>
      </div>
    </div>
<script type="text/javascript">
    $(function(){
  url="/dashboard/check_authentication/";
  $.ajax({
  type: "GET",
  url:url,
  data: {q: <%-JSON.stringify(user.email)%>},
  success: function(res){
  if(res.msg == 'Authenticated'){
   // console.log(res);
    $('#verification').empty();
    $('#verification').append(`
       <form method="GET" action="/dashboard/hospital_update">

    <div class="jumbotron jumbotron-fluid">
    <div class="container">
    <h1 class="display-4">Dashboard</h1>
    <small>Last update: ${JSON.stringify(res.time)} </small>
    <div>
    <p>Beds:</p>
   <button type="button" value="-" class="qty-minus">-</button>
   <input  type="number" id="beds" name="beds" value='${res.beds}' class="qty"></input>
   <button type="button" value="+" class="qty-plus">+</button>
</div>
<div>
    <p>ICUs:</p> 
   <button type="button" value="-" class="qty-minus">-</button>
   <input type="number"  value='${res.ICU}' id="icu" name="icu" class="qty"></input>
   <button type="button" value="+" class="qty-plus">+</button>
</div>
<div>
    <p>Ventilators:</p> 
   <button type="button" value="-" class="qty-minus">-</button>
   <input type="number" value="1" id="vent" name="vents" class="qty"></input>
   <button type="button" value="+" class="qty-plus">+</button>
</div>
  </div> 
   
  <div class="row">
   
    <div class="col" style="padding:5%">
      <div class="input-group mb-3">
  <div class="input-group-prepend">
    <span class="input-group-text" id="basic-addon1">+91</span>
  </div>
  <input type="text" class="form-control" placeholder="patient mobile number" aria-label="Username" aria-describedby="basic-addon1">
</div>


      <input style="width:30%;" type="text" class="form-control" placeholder="Age">
       <label for="inputState">Patient State</label>
      <select id="inputState" class="form-control">
        <option selected>Critical</option>
        <option>Mild</option>
      </select>
     <input class="" type="checkbox" id="gridCheck">
      <label class="form-check-label" for="gridCheck">
        Admitting
      </label>
        <input class="" type="checkbox" id="gridCheck">
      <label class="form-check-label" for="gridCheck">
        Discharging
      </label>
    </div>
  </div>
</form>
        <hr class="my-4">
      
      <button type="submit" class="btn btn-success btn-block">Update</button>
</div>

   </form>
   
    `);
  }//endif
  
  if(res.msg == 'Authenticated2'){
    //console.log(res);
    $('#verification').empty();
    $('#verification').append(`
    <h3>Municipal Officer Dashboard</h3>
       <div class="row">
  <div class="col-sm-6">
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">Reports</h5>
        <p class="card-text">
          <div class="leaderboard">
  <img src="https://cdn1.iconfinder.com/data/icons/user-pictures/100/male3-128.png">
  <p class="leaderboardname">Kashyap Mishra</p>
  <a class="score">Bhatia Hospital:Overcharging</a><a href="#">Read more..</a>
  </div>

<div class="leaderboard">
  <img src="https://cdn1.iconfinder.com/data/icons/user-pictures/100/female1-128.png">
  <p class="leaderboardname">Bhoopendra</p>
  <a class="score">Port Hospital:No ICUs</a><a href="#">Read more..</a>
  </div>


        <style>.leaderboard {
  background: #ededed;
  font-family: 'Source Sans Pro', sans-serif;
  border-radius: 3px;
  width: 100%;
  max-width: 500px;
  min-height: 60px;
  padding: 5px;
  margin: 5px;
  box-shadow: 0 1px 2px rgba(0,0,0,0.25);
margin-left: auto;
	margin-right: auto;
}

.leaderboard img {
  width: 65px;
  height: 65px;
  float: right;
  
  border-radius: 50%;
  border: 3px solid #fff;
 box-shadow: 0 1px 2px rgba(0,0,0,0.25);
}

.leaderboardname {
  font-family: 'Zilla Slab', serif;
  font-size: 20px;
  text-decoration: bold;
}

.sendscore {
 text-decoration: none;
 color: #27ae60;
  font-size: 20px;
font-family: 'Source Sans Pro', sans-serif;
}</style>
        </p>
        <a href="#" class="btn btn-primary">Refresh</a>
      </div>
    </div>
  </div>
  <div class="col-sm-6">
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">Hospitals not updated</h5>
        <p class="card-text">
          <div class="leaderboard">
 
  <p class="leaderboardname">Spandan Hospital</p>
  <p class="score">Last updated: 1 week</p>
  </div>

<div class="leaderboard">
  
  <p class="leaderboardname">Breach Candy Hospital</p>
  <p class="score">Last updated: 2 days</p>
  </div>


        <style>.leaderboard {
  background: #ededed;
  font-family: 'Source Sans Pro', sans-serif;
  border-radius: 3px;
  width: 100%;
  max-width: 500px;
  min-height: 60px;
  padding: 5px;
  margin: 5px;
  box-shadow: 0 1px 2px rgba(0,0,0,0.25);
margin-left: auto;
	margin-right: auto;
}

.leaderboard img {
  width: 65px;
  height: 65px;
  float: right;
  
  border-radius: 50%;
  border: 3px solid #fff;
 box-shadow: 0 1px 2px rgba(0,0,0,0.25);
}

.leaderboardname {
  font-family: 'Zilla Slab', serif;
  font-size: 20px;
  text-decoration: bold;
}

.sendscore {
 text-decoration: none;
 color: #27ae60;
  font-size: 20px;
font-family: 'Source Sans Pro', sans-serif;
}</style>
        </p>
        <a href="#" class="btn btn-primary">Refresh</a>
      </div>
    </div>
  </div>
</div>
    
  
    `);
  }
  
  },
  error: function(err){
  console.log("authentication error:"+err);
  }
  });
  });//end function
$(document).on('click', '.qty-plus', function () {
   $(this).prev().val(+$(this).prev().val() + 1);
});
$(document).on('click', '.qty-minus', function () {
   if ($(this).next().val() > 0) $(this).next().val(+$(this).next().val() - 1);
});
  $(document).on('click','#rectify',function(ev)  {
  ev.preventDefault();
  var str1 = $("#hospital_search"). val();
  //console.log(str1);
  //console.log("rectify");

  url="/rectify/";
  $.ajax({
  type: "GET",
  url:url,
  data: {q: str1},
  success: function(res){
  if(str!=""){

  }
  },
  error: function(err){
  console.log("rectify error:"+err);
  }


  });
  })


  $('#bakwas-2').click(function(ev){
  ev.preventDefault();
  var str = $("#select_state").val();
  //console.log(str);
  $("#info").empty();
  //console.log("clicked");
  url="/dashboard/search-city/";
  $.ajax({
    type: "GET",
    url:url,
    data: {q: str},
    dataType: "jsonp",
    success: function(res){
    console.log(res);
      //now we can access stuff off res
      if(res.length==0){
      $('#alrt').append(`<div class="alert alert-warning alert-dismissible fade show" role="alert">
  <strong>Data Unavailable</strong>We are working on adding this data
  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
    <span aria-hidden="true">&times;</span>
  </button>
</div>`)  
      }
      if(str!=""){
     const container = document.getElementById('info');

      
  res.forEach((result, idx) => {


  // Construct card content
  const content = `
  
   <div class="card col-xs-12 col-md-4 col-lg-4" >
  <div class="card-body" style="padding: 2%">
    <h5 id="hospital-rectify" class="card-title">${res[idx].Hospital}<span>
     ${(() => {
      if (res[idx].score > 500) {
        return `<span class="badge badge-success">5★</span>`
      } else if(res[idx].score >250){
        return `<span class="badge badge-warning">3★</span>`
      }else {
        return `<span class="badge badge-danger">2★</span>`
      }
    })()}
  </span>
    <a class="btn btn-light" href='${"https://www.google.com/maps/search/?api=1&query="+res[idx].Hospital+","+res[idx].City}'><i class="fa fa-location-arrow" aria-hidden="true">Locate</i>
</a>
      
    </h5>  
  <p>

</div>
</p>
  <ul class="list-group">
  <li class="list-group-item list-group-item-light"><h5>Available Beds: ${res[idx].Beds}</h5></li>
    <li class="list-group-item list-group-item-info"><h5>Total Beds: ${res[idx].TOTALBEDS}</h5></li>
    <li class="list-group-item list-group-item-info"><h5>COVID-Beds: ${res[idx].COVIDBEDS}</h5></li>
  <li class="list-group-item list-group-item-info"><h5>Info:${res[idx].info}</h5></li>
  <li class="list-group-item list-group-item-info"><h5>ICU(s):${res[idx].ICU}</h5></li>
  <li class="list-group-item list-group-item-info"><h5>Ventilators:${res[idx].Ventilators}</h5></li>
    <li class="list-group-item list-group-item-warning">
      <h5>COVID charges: ${res[idx].CHARGES}</h5>
    </li>

  </ul>
 

  </div>
</div>
   
  `;

  // Append newyly created card element to the container
  container.innerHTML += content;
})
      }//end if str!=""
      },
  error: function(err){
$('#alrt').append(`<div class="alert alert-warning alert-dismissible fade show" role="alert">
  <strong>Check your connection</strong>Please Reload
  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
    <span aria-hidden="true">&times;</span>
  </button>
</div>`)  }
      
    
  });
});



  $('#bakwas').click(function(ev)  {
  ev.preventDefault();
  var str = $("#hospital_search"). val();
  //console.log(str);
  $("#info").empty();
  console.log("clicked");
  url="/search/";
  $.ajax({
  type: "GET",
  url:url,
  data: {q: str},
  dataType: "jsonp",
  success: function(res){
  //now we can access stuff off res
  if(str!=""){
  $('#info').append(`
  
  <div class="card" >
    <div class="card-body">
      <div style="display:flex; flex-direction: row">
      <h5 id="hospital-rectify" class="card-title">${res[0].Hospital}</h5>
      <a href='${"https://www.google.com/maps/search/?api=1&query="+res[0].Hospital+","+res[0].State}'><i  class="fa fa-location-arrow" aria-hidden="true"> Location</i></a>
      </div>
      <p class="card-text">Info:${res[0].info}</p>
      <p class="card-text">Beds to be increased:${res[0].Beds}</p>
      <p class="card-text">ICU(s):${res[0].ICU}</p>
      <p class="card-text">Ventilators:${res[0].Ventilators}</p>
      <p>
        <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
          Refusal cases
        </button>
      </p>
      <div class="collapse" id="collapseExample">
        <div class="card card-body">
          <p class="card-text">
            <small>
              ${res[0].Refusals}<small>
          </p>
        </div>
      

    </div>
  </div>
    </div>

  `);
  }
  },
  error: function(err){
  console.log("ajax error:"+err);
  }


  });
  });
  $(function () {
  $("#hospital_search").autocomplete({
  source: function (request, response) {
  $.ajax({
  url: "/autocomplete",
  type: "GET",
  data: request,  // request is the value of search input
  success: function (data) {
  var dataArray = [];

  for(var i in data){
  dataArray.push(data[i].Hospital+","+data[i].City);}
  response(dataArray);
  //console.log(data);
  },
  error: function(err){
  console.log(err);
  }
  });
  },

  select: function( event, ui ) {
  $( "#hospital_search" ).val( ui.item.label );

  return false;
  }
  });//autoc
  });//func
</script>
<style>
  body{
margin:0px;  
}
</style>