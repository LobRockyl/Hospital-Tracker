<head>
  <title>Dashboard</title>
<meta name="description" content="The Hospital Tracker is a non-profit social platform aimed to gather these reports against the healthcare giants, 
hospitals, and nursing homes in critical states in India. Instead of just posting on social media, we gather 
authenticated reports against the hospitals or anything related, so that this pack of authenticated reports and 
behaviour can be claimed by the people who practice law or are at a place of power to take action based on authenticated hospital data" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"></link>
  <script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous"></script>
  <script
        src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"
        integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut"
        crossorigin="anonymous"
    ></script>
  <script
    src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"
    integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
    crossorigin="anonymous"
    ></script>
  
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>


  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css"/>
</head>
<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Complaint Status</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
       <p><%= typeof msg != 'undefined' ? msg+" report(s) under review. You will recieve an email regarding the same." : 'You have not submitted any complaints' %></p>
       <p><small>Please submit the form carefully and under the correct category.
       Only one report is allowed per user uptill it has been verified. For more information <a>Click Here</a></small></p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div style="display:flex; flex-direction: row">
<h1>Hello </h1>
  <div class="dropdown">
    <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      <%=user.name%> <i class="fa fa-user-circle-o" aria-hidden="true"></i>
    </button>
    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
      <a id="complaint_status" class="dropdown-item" data-toggle="modal" data-target="#exampleModal">Complaint status</a>
      <a class="dropdown-item" href="users/logout">Logout</a>
    </div>
  </div>

</div>
<div class="jumbotron jumbotron-fluid">
  <div class="container">
    <div class="ui-widget" style="z-index:9999">
      <form action="/search" method="POST" class="form-inline my-2 my-lg-0" id="chutiya" style="width:90%;display:flex;flex-direction: row;flex-flow:row;">
        <input style="width:90%" class="form-control mr-sm-2" id="hospital_search" type="search" placeholder="Search Hospital" aria-label="Search"/>
        <button  id="bakwas" class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
      </form>
    </div>
    <p>Didn't find your hospital, report a problem to us...</p>
    <small>Information here is either from recognized news or from authentic crowdsourced information</small>

  </div>
</div>
<div id="info"   style="">
  
</div>

<div class="accordion" id="accordionExample">
  <div class="card">
    <div class="card-header" id="headingOne">
      <h2 class="mb-0">
        <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
          <h3><i class="fa fa-heartbeat" aria-hidden="true"></i>
          Patient</h3>
        </button>
      </h2>
    </div>

    <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordionExample">
      <div class="card-body">
         <form action="/dashboard/submit" method="POST">
          <div class="form-group">
            <label for="name">Name</label>
            
            <input type="name" name="name" class="form-control" id="name" value="<%= typeof name != 'undefined' ? name : '' %>" placeholder="<%=user.name%>">
          </div>
          <div class="form-group">
            <label for="pselect">Type:</label>
            <select class="form-control" id="pselect" name="pselect" value="<%= typeof pselect != 'undefined' ? pselect : '' %>">
              <option>Patient</option>
              <option>Related or Other</option>
            </select>
          </div>

          <div class="form-group">
            <label for="pdesc">Problem Description</label>
            <input class="form-control" id="pdesc" name="pdesc" value="<%= typeof pdesc != 'undefined' ? pdesc : '' %>" rows="3"></input>
          </div>
           <div class="form-group">
             <label for="pcheck">Type:</label>
             <select class="form-control" id="pcheck" name="pcheck">
               <option>I will be able to provide evidence to my problem(Recommended)</option>
               <option>No evidence can be provided by me</option>
             </select>
           </div>
           <button type="submit" id="dashboard_submit" class="btn btn-primary" style="display:<%= typeof msg != 'undefined'? "none" : 'block'%>">Submit</button>
        </form> 
      </div>
    </div>
  </div>
  <div class="card">
    <div class="card-header" id="headingTwo">
      <h2 class="mb-0">
        <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
          <h3>
            <i class="fa fa-stethoscope" aria-hidden="true"></i>
            Doctor
          </h3>
        </button>
      </h2>
    </div>
    <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionExample">
      <div class="card-body">
        <form action="/dashboard/docsubmit" method="POST">
          <div class="form-group">
            <label for="exampleFormControlInput1">Name</label>
            <input type="name" name="name" class="form-control" id="name" value="<%= typeof name != 'undefined' ? name : '' %>" placeholder="<%=user.name%>">
          </div>
          <div class="form-group" id="Registration_number">
            <label for="exampleFormControlInput1">MCI Registration number</label>

            <input type="reg_no" id="reg_no" name="reg_no" class="form-control"  placeholder="MCI/Registration ID">
          </div>
         
          <div class="form-group" id="">
            <label for="exampleFormControlInput1">State Medical Council</label>

            <input  class="form-control" type="council" id="council" name="council" placeholder="example: West Bengal Medical Council">
          </div>
          <div class="form-group" id="">
            <input type="email" class="form-control" type="qualification" id="qualification" name="qualification" placeholder="Qualification">
          </div>
          <div class="form-group" id="">
            <label for="exampleFormControlInput1">Add/Rectify/Claim:</label>

            <input type="rectify_data" id="rectify_data" name="rectify_data" class="form-control"  placeholder="Data you want to add/rectify">
          </div>
          <div class="form-group" id="">
            <label for="exampleFormControlInput1">Any other problems(if any):</label>

            <input class="form-control" type="problem" id="problem" name="problem" placeholder="Problem/Query">
          </div>
          <div class="form-group">
            <label for="exampleFormControlTextarea1">Brief Description</label>
            <input type="doc_desc" id="doc_desc" name="doc_desc" class="form-control" ></input>
          </div>
          <div class="form-group">
            <label for="doccheck">Type:</label>
            <select class="form-control" id="doccheck" name="doccheck" >
              <option>I would be able to provide evidence to my problem(Recommended)</option>
              <option>No evidence</option>
            </select>
          </div>
          <button type="submit" id="dashboard_submit" class="btn btn-primary" style="display:"
            <%= typeof msg != 'undefined'? "none" : 'block'%>">Submit
          </button>

        </form>
      </div>
    </div>
  </div>
  <div class="card">
    <div class="card-header" id="headingThree">
      <h2 class="mb-0">
        <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
         <h3>
           <i class="fa fa-medkit" aria-hidden="true"></i>
           Healthcare Professional</h3>
        </button>
      </h2>
    </div>
    <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordionExample">
      <div class="card-body">
        <form action="/dashboard/staffsubmit" method="POST">
          <div class="form-group">
            <label for="exampleFormControlInput1">Name</label>
            <input  class="form-control" type="name" id="name" name="name" placeholder="<%=user.name%>">
            
          </div>
          <div class="form-group">
            <label for="exampleFormControlInput1">Verification</label>
            <input  class="form-control" type="verify" id="verify" name="verify" placeholder="Any information to verify your designation">
          </div>
          <div class="form-group">
            <label for="exampleFormControlTextarea1">Problem Description</label>
            <input class="form-control" type="pdesc" id="pdesc" name="pdesc"></input>
          </div>
          <div class="form-group">
            <label for="scheck">Type:</label>
            <select class="form-control" id="scheck" name="scheck">
              <option>I would be able to provide evidence to my problem(Recommended)</option>
              <option>No evidence</option>
            </select>
          </div>
          <button type="submit" id="dashboard_submit" class="btn btn-primary" style="display:"
            <%= typeof msg != 'undefined'? "none" : 'block'%>">Submit
          </button>

        </form>
      </div>
    </div>
  </div>
  <div class="card">
    <div class="card-header" id="headingOne">
      <h2 class="mb-0">
        <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseFour" aria-expanded="true" aria-controls="collapseFour">
          <h3>Any other concerned citizen...</h3>
        </button>
      </h2>
    </div>
    <div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-parent="#accordionExample">
      <div class="card-body">
        <form action="/dashboard/othersubmit" method="POST">
          <div class="form-group">
            <label for="name">Name</label>
            <input type="name" id="name" name="name" class="form-control" id="exampleFormControlInput1" placeholder=<%=user.name%>>
          </div>
          <div class="form-group">
            <label for="exampleFormControlInput1">Profession</label>
            <input  class="form-control" type="occ" id="occ" name="occ" placeholder="example: Govt. Service at Organization">
          </div>
              
          <div class="form-group">
            <label for="opdesc">Problem Description</label>
            <input class="form-control" type="opdesc" id="opdesc" name="opdesc"></input>
          </div>
          <div class="form-group">
            <label for="opcheck">Type:</label>
            <select class="form-control" id="opcheck" name="opcheck">
              <option>I would be able to provide evidence to my problem(Recommended)</option>
              <option>No evidence</option>
            </select>
          </div>
          <button type="submit" id="dashboard_submit" class="btn btn-primary" style="display:"
            <%= typeof msg != 'undefined'? "none" : 'block'%>">Submit
          </button>

        </form>
      </div>
    </div>
  </div>
</div>
<div class="card mb-3" style="max-width:100%;">
      <div class="row no-gutters">
        <div class="col-md-4">
          <img src="https://i.imgur.com/SqQWbJb.png" class="card-img" alt="ss">
    </div>
        <div class="col-md-8">
          <div class="card-body">
            <h5 class="card-title" href="/app">The Hospital Tracker</h5>
            <p class="card-text">A handy tool to get your hospital's information.</p>
            <p class="card-text">
              <a href="/app">
                <i class="fa fa-download" aria-hidden="true"></i> Download
              </a>
            </p>
          </div>

        </div>
      </div>
    </div>
<script type="text/javascript">
  $(document).on('click','#rectify',function(ev)  {
  ev.preventDefault();
  var str1 = $("#hospital_search"). val();
  console.log(str1);
  //console.log("rectify");

  url="/rectify/";
  $.ajax({
  type: "GET",
  url:url,
  data: {q: str1},
  success: function(res){
  if(str!=""){

  }
  },
  error: function(err){
  console.log("rectify error:"+err);
  }


  });
  })



  $('#bakwas').click(function(ev)  {
  ev.preventDefault();
  var str = $("#hospital_search"). val();
  //console.log(str);
  $("#info").empty();
  console.log("clicked");
  url="/search/";
  $.ajax({
  type: "GET",
  url:url,
  data: {q: str},
  dataType: "jsonp",
  success: function(res){
  //now we can access stuff off res
  if(str!=""){
  $('#info').append(`
  
  <div class="card" style="width: 90%;">
    <div class="card-body">
      <h5 id="hospital-rectify" class="card-title">${res[0].Hospital}</h5>
      <p class="card-text">Info:${res[0].info}</p>
      <p class="card-text">Beds to be increased:${res[0].Beds}</p>
      <p class="card-text">ICU(s):${res[0].ICU}</p>
      <p class="card-text">Ventilators:${res[0].Ventilators}</p>
      <p>
        <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
          Refusal cases
        </button>
      </p>
      <div class="collapse" id="collapseExample">
        <div class="card card-body">
          <p class="card-text">
            <small>
              ${res[0].Refusals}<small>
          </p>
        </div>
      

    </div>
  </div>
    </div>

  `);
  }
  },
  error: function(err){
  console.log("ajax error:"+err);
  }


  });
  });
  $(function () {
  $("#hospital_search").autocomplete({
  source: function (request, response) {
  $.ajax({
  url: "/autocomplete",
  type: "GET",
  data: request,  // request is the value of search input
  success: function (data) {
  var dataArray = [];

  for(var i in data){
  dataArray.push(data[i].Hospital+","+data[i].State);}
  response(dataArray);
  //console.log(data);
  },
  error: function(err){
  console.log(err);
  }
  });
  },

  select: function( event, ui ) {
  $( "#hospital_search" ).val( ui.item.label );

  return false;
  }
  });//autoc
  });//func
</script>
